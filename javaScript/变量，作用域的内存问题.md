## 一 基本类型和引用类型的值
基本类型值指的是简单的数据段，而引用类型值指那些可能由多个值构成的对象。引用类型的值指的是保存在内存中的对象。
与其他语言不同，JavaScript不能直接操作对象的内存空间
##### 1）复制变量值
从一个变量向另一个变量复制基本类型值和引用类型值时，两者存在不同。
- 复制基本类型值
  会创建一个新值然后将该值复制到新分配的位置上

      var  n1 = 5;
      var n2 = n1;
- 复制引用变量值
同样也回将存储在变量中的值复制一份放到为新变量分配的空间中，不同的时，副本实际上是一个指针，指向堆中的一个对象，两个变量实际上将引用同一个对象，因此，改变其中一个变量，会影响另一个变量。

      var obj1 = new Object();
      var obj2 = obj1;
      obj1.name = "zhong";
      alert(obj2.name);      //"zhong"
##### 2) 传递参数
ECMASript中所有函数的参数都是按值传递的。也就是说，把函数外部的值复制给函数内部的参数，就和把值从一个变量复制到另一个变量一样 。
注意：对象也是按值传递的，而不是按引用传递的。

    function setName(obj) {
        obj.name = "zhong";
        obj = new Object();
        obj.name = "Grag";
    }
    
    var person = new Objecct();
    setName(person);
    alert(person.name);      //"zhong"
如果person是按引用传递的，那么person自然会被修改为指向其name的属性值的为"Grag"的新对象。函数内部修改了参数的值，但原始的引用仍然保持不变。可一将函数的参数视为局部变量。
##### 3）检测类型 
用instanceof 操作符可以用来检测对象的类型。如果变量是给定引用类型的实例，那么会返回true。
所有的引用类型的值都是Object的实例。
## 二 执行环境和作用域
执行环境定义了变量或函数有权访问的其他数据，决定了它们各自的行为。每个执行环境都有一个与之关联的变量对象，环境中定义的所有变量和函数都保存在这个对象中。
当代码在环境中执行时，会创建变量对象的一个作用域链。
##### 1）延长作用域链
当执行流进入以下任何一个语句时，作用域链就会得到加长：
- try-catch语句的catch块
- with语句
对于with语句来说，会将指定对象添加到作用域链中。对于catch语句来说，会创建一个新的变量对象，其中包含的是被抛出的错误对象的声明。

      function buildUrl () {
            var qs = "?debug = true";
            with(location) {
                var url = href + qs;
           }
           return url;
      }
##### 2) 没有块级作用域
不像其他的类c的语言，由花括号封闭的代码都有自己的作用域（注意不要与函数中的局部变量混淆，函数不是块级）

    if (true) {
        var color = "blue";
    }
    alert(color);      //"blue"
注意if中的变量会添加到当前的全局环境中，尤其是对于for语句中的 i 来说

    for (var i = 0; i < 10; i++) {
          do(i);
    }
    alert(i);     //10
## 三 垃圾收集
JavaScript具有自动的垃圾收集机制，执行环境会负责代码执行过程中使用的内存。
原理：找出不再需要的变量，然后释放其占用的内存，为此，垃圾回收器会按照固定的时间间隔（或代码执行过程中预定的收集时间），周期性地执行这一操作。
##### 1）标记清除
这是JavaScript中最常见地垃圾收集方式。变量进入环境，标记为"进入环境"，离开环境,标记为"离开环境"。垃圾回收器会将离开环境的值销毁，完成内存清除工作，释放内存空间。
##### 2）引用次数
不太常见，容易导致循环引用
原理：引用计数的含义式跟踪记录每一个值被引用的次数。当声明一个变量并将一个引用类型值赋给该变量时，则这个值的引用次数就是1。如果同一个值又赋给另一个变量，则该值的引用次数加1。 相反，如果包含对这个值的引用的变量又取得了另外一个值，则这个值的引用次数减1 。当这个值的引用次数变为0时，则说明没有办法再再访问这个值了，因而可以将其占用的内存空间回收回来，以便垃圾回收器释放内存。

问题：循环引用，循环引用是指对象A 中包含一个指向对象B的指针，而对象B 中包含一个指向对象A的引用。

    function problem() {
        var objA = new Object();
        var objB = new Object();

        objA.someOtherObject = objB;
        objB.anotherObject = objA;
    }
在这个例子中，objA 和 objB 通过各自的属性相互引用，也就是说，这两个对象的引用次数都是2 。如果使用引用计数策略，如果该函数被多次调用，就会导致大量内存得不到释放。
##### 3）管理内存
确保占用最少的内存可以让页面获得更好的性能。而优化内存的最佳方式，就是为执行中的代码只保存必要的数据。一旦数据不可用，最好通过将其值设置为null来释放其引用——即解除引用。局部变量会在他们离开执行环境时自动被解除引用

    function createPerson(name) {
        var localPerson = new Object();
        localPerson.name = name;
        return localPerson;
    }
  
    var globalPerson = createPerson("zhong");
    //手工解除globalPerson的引用
    globalPerson = null;
注意： 解除一个值的引用并不意味着自动回收该值所占的内存。解除引用的真正目的是让值脱离执行环境，以便垃圾回收器下次运行时将其回收。
